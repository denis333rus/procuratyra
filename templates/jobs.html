{% extends 'layout.html' %}
{% block title %}Приём на работу{% endblock %}
{% block content %}
  <style>
    .job-wrap { max-width: 980px; margin: 0 auto; display: grid; gap: 20px; }
    .job-header { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color:#fff; padding: 22px; border-radius: 16px; box-shadow: 0 8px 28px rgba(102,126,234,.28); }
    .job-header h1 { margin: 0; font-size: 26px; font-weight: 800; }
    .job-card { background: #fff; border: 1px solid #e6ecff; border-radius: 16px; box-shadow: 0 4px 18px rgba(0,0,0,.08); padding: 20px; }
    .form-grid { display: grid; gap: 14px; }
    .grid-2 { grid-template-columns: 1fr 1fr; }
    .field { display: grid; gap: 6px; }
    .label { font-size: 14px; color: #2b3a5a; font-weight: 700; }
    .input, .textarea, .select { width: 100%; padding: 12px 14px; border: 1.5px solid #cfe0ff; border-radius: 10px; background: #fbfdff; font: inherit; }
    .textarea { min-height: 110px; resize: vertical; }
    .help { font-size: 12px; color: #6b7aa6; }
    .actions { display: flex; gap: 10px; margin-top: 6px; }
    @media (max-width: 720px) { .grid-2 { grid-template-columns: 1fr; } }
  </style>

  <div class="job-wrap">
    <div class="job-header">
      <h1>Приём на работу</h1>
    </div>

    <div class="job-card">
      <form method="post" action="/jobs" class="form-grid" id="job-form">
        <div class="form-grid grid-2">
          <div class="field">
            <label class="label" for="nick_ds">Ваш ник в ДС</label>
            <input class="input" id="nick_ds" name="nick_ds" type="text" placeholder="@username">
          </div>
          <div class="field">
            <label class="label" for="nick_roblox">Ваш ник в Roblox</label>
            <input class="input" id="nick_roblox" name="nick_roblox" type="text" placeholder="RobloxNick">
          </div>
        </div>

        <div class="field">
          <label class="label" for="char_name">ФИО персонажа <span aria-hidden="true">*</span></label>
          <input class="input" id="char_name" name="char_name" type="text" required>
        </div>

        <div class="form-grid grid-2">
          <div class="field">
            <label class="label" for="real_age">Сколько вам лет в реале? <span aria-hidden="true">*</span></label>
            <input class="input" id="real_age" name="real_age" type="number" required>
          </div>
          <div class="field">
            <label class="label" for="char_birth">Дата рождения вашего персонажа <span aria-hidden="true">*</span></label>
            <input class="input" id="char_birth" name="char_birth" type="date" required>
          </div>
        </div>

        <div class="form-grid grid-2">
          <div class="field">
            <label class="label" for="date_now">Дата</label>
            <input class="input" id="date_now" name="date_now" type="date">
          </div>
          <div class="field">
            <label class="label" for="char_age">Сколько лет вашему персонажу? <span aria-hidden="true">*</span></label>
            <input class="input" id="char_age" name="char_age" type="number" required>
          </div>
        </div>

        <div class="form-grid grid-2">
          <div class="field">
            <label class="label" for="char_nationality">Национальность персонажа <span aria-hidden="true">*</span></label>
            <input class="input" id="char_nationality" name="char_nationality" type="text" required>
          </div>
          <div class="field">
            <label class="label" for="char_job">Работа, на которой работает персонаж</label>
            <input class="input" id="char_job" name="char_job" type="text" placeholder="Например: юрист, следователь">
          </div>
        </div>

        <div class="field">
          <label class="label" for="char_education">Образование вашего персонажа</label>
          <input class="input" id="char_education" name="char_education" type="text" placeholder="Например: высшее юридическое, МГУ, 2022">
        </div>

        <div class="field">
          <label class="label" for="about">Расскажите о себе <span aria-hidden="true">*</span></label>
          <textarea class="textarea" id="about" name="about" rows="4" required></textarea>
        </div>

        <div class="field">
          <label class="label" for="what_is_prosecutor">Объясните своими словами, что такое прокуратура <span aria-hidden="true">*</span></label>
          <textarea class="textarea" id="what_is_prosecutor" name="what_is_prosecutor" rows="4" required></textarea>
        </div>

        <div class="field">
          <label class="label" for="literacy_test">Проверка на грамотность: напишите минимум 5 сложных предложений грамотно <span aria-hidden="true">*</span></label>
          <textarea class="textarea" id="literacy_test" name="literacy_test" rows="6" required></textarea>
          <div class="help">Постарайтесь раскрыть мысль и показать владение письменной речью.</div>
          <div id="literacy_error" style="color: #dc3545; font-size: 12px; margin-top: 4px; display: none;">Минимальное количество предложений: 5</div>
        </div>

        <div class="form-grid grid-2">
          <div class="field">
            <label class="label">Имеете ли судимости? <span aria-hidden="true">*</span></label>
            <select class="select" name="has_convictions" required>
              <option value="">Выберите...</option>
              <option value="no">Нет</option>
              <option value="yes">Да</option>
            </select>
          </div>
          <div class="field">
            <label class="label">Имеете ли вы опыт? <span aria-hidden="true">*</span></label>
            <select class="select" name="has_experience" required>
              <option value="">Выберите...</option>
              <option value="no">Нет</option>
              <option value="yes">Да</option>
            </select>
          </div>
        </div>

        <div class="field">
          <label class="label">Расшифруйте термины:</label>
          <div class="form-grid grid-2">
            <input class="input" name="term_upk" type="text" placeholder="УПК — ...">
            <input class="input" name="term_uk" type="text" placeholder="УК — ...">
          </div>
          <div class="form-grid grid-2">
            <input class="input" name="term_koap" type="text" placeholder="КоАП — ...">
            <input class="input" name="term_tk" type="text" placeholder="ТК — ...">
          </div>
        </div>
        <div class="field">
          <label class="label">Желаемый пароль для входа в систему <span aria-hidden="true">*</span></label>
          <input class="input" name="password" type="text" placeholder="Пароль" required>
        </div>
        <div class="field">
          <label class="label">Желаемый логин для входа в систему <span aria-hidden="true">*</span></label>
          <input class="input" name="login" type="text" placeholder="Логин" required>
        </div>

        <div class="actions">
          <button class="btn btn--primary" type="submit">Отправить</button>
          <a class="btn" href="/">На главную</a>
        </div>
      </form>
    </div>
  </div>

  <script>
    document.getElementById('job-form').addEventListener('submit', function(e) {
      const literacyTest = document.getElementById('literacy_test').value.trim();
      const errorDiv = document.getElementById('literacy_error');
      
      // Подсчитываем количество предложений (разделители: . ! ?)
      const sentences = literacyTest.split(/[.!?]+/).filter(s => s.trim().length > 0);
      
      if (sentences.length < 5) {
        e.preventDefault();
        errorDiv.style.display = 'block';
        document.getElementById('literacy_test').style.borderColor = '#dc3545';
        return false;
      } else {
        errorDiv.style.display = 'none';
        document.getElementById('literacy_test').style.borderColor = '';
      }
    });

    // Реальное время валидация
    document.getElementById('literacy_test').addEventListener('input', function() {
      const literacyTest = this.value.trim();
      const errorDiv = document.getElementById('literacy_error');
      const sentences = literacyTest.split(/[.!?]+/).filter(s => s.trim().length > 0);
      
      if (sentences.length < 5 && literacyTest.length > 0) {
        errorDiv.style.display = 'block';
        this.style.borderColor = '#dc3545';
      } else {
        errorDiv.style.display = 'none';
        this.style.borderColor = '';
      }
    });
  </script>
{% endblock %}


